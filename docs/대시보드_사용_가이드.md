# 제조 시뮬레이션 대시보드 사용 가이드

## 📋 개요

이 문서는 SimPy 기반 제조 시뮬레이션 프레임워크의 실시간 대시보드 시스템 사용법을 설명합니다. 대시보드를 통해 시뮬레이션 데이터를 실시간으로 모니터링하고 분석할 수 있습니다.

## 🎯 주요 기능

### 1. 실시간 모니터링
- **KPI 카드**: 처리량, 사용률, 품질 점수 등 주요 성과 지표 실시간 표시
- **게이지 차트**: 전체 시스템 사용률을 직관적인 게이지로 표시
- **시계열 차트**: 성능 지표의 시간별 변화 추이 분석
- **알림 시스템**: 임계값 위반 시 자동 알림 생성

### 2. 시각화 컴포넌트
- **막대 차트**: 리소스별 사용률 비교
- **원형 차트**: 리소스 타입별 분포 및 비율 표시
- **영역 차트**: 누적 데이터 및 트렌드 분석
- **히스토그램**: 처리 시간 분포 등 통계 분석

### 3. 인터랙티브 기능
- **자동 갱신**: 설정 가능한 간격으로 데이터 자동 업데이트
- **필터링**: 시간 범위, 리소스 타입별 데이터 필터링
- **데이터 내보내기**: JSON, CSV 형식으로 데이터 다운로드
- **상세 분석**: 드릴다운을 통한 세부 정보 확인

## 🚀 시작하기

### 1. 환경 설정

먼저 필요한 패키지를 설치합니다:

```bash
pip install -r requirements.txt
```

주요 패키지:
- `streamlit`: 웹 대시보드 프레임워크
- `plotly`: 인터랙티브 차트 라이브러리
- `pandas`: 데이터 처리
- `numpy`: 수치 계산

### 2. 대시보드 실행

#### 방법 1: Streamlit 앱 직접 실행
```bash
cd src/dashboard
streamlit run dashboard_app.py
```

#### 방법 2: Python 코드에서 실행
```python
from src.dashboard.dashboard_app import SimulationDashboardApp

app = SimulationDashboardApp()
app.run()
```

### 3. 시뮬레이션과 연동

```python
from src.core.centralized_statistics import CentralizedStatisticsManager
from src.dashboard.real_time_connector import initialize_real_time_system

# 통계 관리자 생성
stats_manager = CentralizedStatisticsManager()

# 실시간 연동 시스템 초기화
data_bridge = initialize_real_time_system(stats_manager, update_interval=1.0)

# 시뮬레이션 실행...
```

## 🎛️ 대시보드 구성 요소

### 1. KPI 카드 섹션

**위치**: 대시보드 상단
**기능**: 주요 성과 지표를 카드 형태로 표시

**KPI 항목**:
- **총 처리량**: 시간당 처리된 단위 수 (units/hour)
- **전체 사용률**: 모든 리소스의 평균 사용률 (%)
- **활성 리소스**: 현재 가동 중인 리소스 수
- **평균 사이클 타임**: 평균 처리 시간 (분)
- **품질 점수**: 품질 관리 점수 (%)
- **시뮬레이션 시간**: 현재 시뮬레이션 경과 시간

**특징**:
- 실시간 값 표시
- 목표 대비 차이(델타) 표시
- 색상으로 상태 구분 (정상/주의/위험)

### 2. 실시간 모니터링 섹션

#### 리소스 사용률 차트
- **타입**: 막대 차트
- **내용**: 각 리소스(기계, 작업자 등)의 현재 사용률
- **기능**: 
  - 임계값 선 표시 (80%, 90%)
  - 색상 코딩 (정상: 파란색, 주의: 주황색, 위험: 빨간색)
  - 호버로 상세 정보 확인

#### 전체 사용률 게이지
- **타입**: 게이지 차트
- **내용**: 전체 시스템의 평균 사용률
- **기능**:
  - 반원형 게이지 표시
  - 색상 구간별 임계값 표시
  - 목표값 대비 차이 표시

#### 시계열 분석 차트
- **타입**: 다중 선형 차트
- **내용**: 처리량과 사용률의 시간별 변화
- **기능**:
  - 실제값과 목표값 비교
  - 확대/축소 가능한 시간축
  - 범례를 통한 시리즈 선택

### 3. 상세 분석 섹션

#### 리소스 분석 탭
- **리소스 타입별 분포**: 원형 차트로 리소스 구성 표시
- **효율성 분포**: 사용률 구간별 리소스 수 표시
- **리소스 상태 요약**: 가동/대기/정비 상태별 통계

#### 품질 분석 탭
- **품질 트렌드**: 시간별 품질 점수 변화
- **품질 통계**: 평균, 최저, 최고, 편차 표시
- **목표 달성률**: 품질 목표 대비 달성 현황

#### 알림 및 이벤트 탭
- **실시간 알림**: 레벨별 색상 구분 알림 표시
- **이벤트 로그**: 시스템 이벤트 시간순 나열
- **알림 통계**: 레벨별 알림 발생 빈도

## ⚙️ 설정 및 커스터마이징

### 1. 사이드바 설정

#### 자동 갱신 설정
- **체크박스**: 자동 갱신 활성화/비활성화
- **슬라이더**: 갱신 간격 조정 (1-30초)
- **수동 갱신 버튼**: 즉시 데이터 업데이트

#### 시뮬레이션 제어
- **시작 버튼**: 시뮬레이션 모니터링 시작
- **정지 버튼**: 모니터링 일시 정지
- **상태 표시**: 현재 모니터링 상태 확인

#### 데이터 내보내기
- **JSON 다운로드**: 현재 대시보드 데이터를 JSON 파일로 저장
- **CSV 내보내기**: 표 형태 데이터를 CSV로 저장
- **리포트 생성**: 종합 분석 리포트 PDF 생성

### 2. KPI 임계값 설정

```python
from src.dashboard.kpi_widgets import KPIThreshold, KPIData

# 처리량 KPI 임계값 설정
throughput_threshold = KPIThreshold(
    warning_min=80,      # 주의 하한값
    warning_max=120,     # 주의 상한값
    critical_min=60,     # 위험 하한값
    critical_max=150,    # 위험 상한값
    target=100           # 목표값
)
```

### 3. 차트 커스터마이징

#### 색상 테마 변경
```python
# 커스텀 색상 팔레트
custom_colors = {
    'primary': '#1f77b4',
    'secondary': '#ff7f0e',
    'success': '#28a745',
    'warning': '#ffc107',
    'danger': '#dc3545'
}
```

#### 레이아웃 조정
```python
from src.dashboard.layouts import DashboardLayout, LayoutType

# 커스텀 레이아웃 생성
layout = DashboardLayout(LayoutType.MONITORING)
fig = layout.create_manufacturing_dashboard(data)
```

## 📊 데이터 연동 가이드

### 1. 실시간 데이터 연동

```python
from src.dashboard.real_time_connector import DataBridge, RealTimeDataProvider

# 데이터 브릿지 설정
bridge = DataBridge(update_interval=1.0)
bridge.connect_simulation(stats_manager)
bridge.start_monitoring()

# 데이터 제공자 설정
provider = RealTimeDataProvider(bridge)
dashboard_data = provider.get_dashboard_data()
```

### 2. 커스텀 KPI 추가

```python
from src.dashboard.kpi_widgets import KPIManager, KPIData, KPIThreshold

# KPI 관리자 생성
kpi_manager = KPIManager()

# 커스텀 KPI 정의
custom_kpi = KPIData(
    name="커스텀 지표",
    value=0.0,
    unit="units",
    threshold=KPIThreshold(target=100)
)

# KPI 등록 및 업데이트
kpi_manager.register_kpi("custom_metric", custom_kpi)
kpi_manager.update_kpi("custom_metric", 95.5)
```

### 3. 알림 시스템 활용

```python
from src.dashboard.kpi_widgets import AlertSystem, AlertLevel

# 알림 시스템 생성
alert_system = AlertSystem()

# 커스텀 알림 추가
alert_system.add_alert(
    level=AlertLevel.WARNING,
    message="Machine_05 사용률 85% 도달",
    source="Custom Monitor"
)

# 알림 구독
def alert_handler(alert):
    print(f"새 알림: {alert['message']}")

alert_system.subscribe(alert_handler)
```

## 🔧 문제 해결

### 1. 일반적인 문제

#### 대시보드가 실행되지 않는 경우
1. **패키지 설치 확인**:
   ```bash
   pip install streamlit plotly pandas numpy
   ```

2. **포트 충돌 해결**:
   ```bash
   streamlit run dashboard_app.py --server.port 8502
   ```

3. **메모리 부족 시**:
   - 데이터 히스토리 크기 조정
   - 업데이트 간격 증가

#### 데이터가 표시되지 않는 경우
1. **시뮬레이션 연결 확인**:
   ```python
   if bridge.stats_manager is None:
       print("시뮬레이션이 연결되지 않음")
   ```

2. **데이터 수집 상태 확인**:
   ```python
   latest_data = bridge.get_latest_data()
   if latest_data is None:
       print("수집된 데이터가 없음")
   ```

#### 성능 이슈
1. **업데이트 간격 조정**: 1초 → 5초
2. **히스토리 크기 제한**: 최대 100개 스냅샷
3. **차트 데이터 포인트 제한**: 최대 50개 포인트

### 2. 고급 설정

#### 멀티 프로세스 환경
```python
import multiprocessing

# 별도 프로세스에서 대시보드 실행
def run_dashboard():
    app = SimulationDashboardApp()
    app.run()

dashboard_process = multiprocessing.Process(target=run_dashboard)
dashboard_process.start()
```

#### 원격 데이터 연결
```python
# 네트워크를 통한 데이터 수신
import socket
import json

def network_data_collector():
    # 네트워크 소켓을 통한 데이터 수집
    pass
```

## 📈 활용 사례

### 1. 생산 라인 모니터링
- 실시간 처리량 추적
- 병목 지점 식별
- 품질 관리 모니터링

### 2. 리소스 최적화
- 사용률 분석을 통한 리소스 배치 최적화
- 유지보수 스케줄링
- 용량 계획 수립

### 3. 성능 분석
- KPI 트렌드 분석
- 목표 달성률 추적
- 개선 효과 측정

## 🆘 지원 및 문의

### 문서 및 예제
- 프로젝트 README.md 참조
- `/docs` 폴더의 상세 가이드 참조
- `/scenario` 폴더의 예제 코드 참조

### 기술 지원
- GitHub Issues 페이지에 문제 보고
- 커뮤니티 포럼에서 질문
- 개발팀에 직접 문의

### 업데이트 정보
- 정기적인 기능 업데이트
- 보안 패치 적용
- 사용자 피드백 반영

---

*이 가이드는 v1.0 기준으로 작성되었으며, 새로운 기능이 추가되면 업데이트됩니다.*
